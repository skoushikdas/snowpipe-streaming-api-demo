from pyspark.sql import SparkSession
from ingestion.utils.logging. log_util import Logger
class SparkSessionSingleton (classmethod):
instance = None
@classmethod
def get spark session (cls) -> object:
logger
=
Logger.getlogger ("SPARK-SESSION")
if cls. instance is None:
cls.
instance
=
SparkSession.builder \
.appName ("kafka-snowflake-pipeline") \
.getOrCreate()
logger.info("Single Spark Session created
return cls. instance
